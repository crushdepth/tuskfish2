<?php declare(strict_types=1); ?>
<div class="container">
  <div class="row">
    <div class="col">
      <h1 class="page-title"><?php echo xss($viewModel->pageTitle()); ?></h1>
      <p class="text-center description"><?php echo TFISH_EXPERTS_BROWSE . '.'; ?></p>
    </div>
  </div>

  <form class="form-horizontal" name="selectFilters" action="<?php echo TFISH_EXPERTS_URL; ?>" method="post">
    <div class="row">
      <div class="col-md-8 col-lg-5 mx-auto">
        <p class="text-center description"><a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=a'; ?>">[A]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=b'; ?>">&nbsp;[B]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=c'; ?>">&nbsp;[C]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=d'; ?>">&nbsp;[D]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=e'; ?>">&nbsp;[E]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=f'; ?>">&nbsp;[F]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=g'; ?>">&nbsp;[G]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=h'; ?>">&nbsp;[H]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=i'; ?>">&nbsp;[I]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=j'; ?>">&nbsp;[J]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=k'; ?>">&nbsp;[K]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=l'; ?>">&nbsp;[L]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=m'; ?>">&nbsp;[M]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=n'; ?>">&nbsp;[N]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=o'; ?>">&nbsp;[O]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=p'; ?>">&nbsp;[P]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=q'; ?>">&nbsp;[Q]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=r'; ?>">&nbsp;[R]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=s'; ?>">&nbsp;[S]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=t'; ?>">&nbsp;[T]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=u'; ?>">&nbsp;[U]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=v'; ?>">&nbsp;[V]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=w'; ?>">&nbsp;[W]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=x'; ?>">&nbsp;[X]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=y'; ?>">&nbsp;[Y]&nbsp;</a>
          <a href="<?php echo TFISH_EXPERTS_URL . '?action=name&amp;alpha=z'; ?>">&nbsp;[Z]</a>
        </p>
     </div>
    </div>

    <!-- Select filters -->
    <div class="row select-filters justify-content-center">

      <div class="col-sm-6 col-md-3 col-lg-2">
        <select class="form-control custom-select" name="tag" id="tag" onchange="this.form.submit()">
        <?php foreach ($viewModel->activeTagOptions() as $key => $value) {
          echo ($key === $viewModel->tag()) ?
            '<option value="' . xss($key) . '" selected>' . xss($value) . '</option>' :
            '<option value="' . xss($key) . '">' . xss($value) . '</option>';
        } ?>
        </select>
      </div>

      <div class="col-sm-6 col-md-3 col-lg-2">
        <select class="form-control custom-select" name="country" id="country" onchange="this.form.submit()">
          <?php foreach ($viewModel->countryList() as $key => $value) {
            echo ($key === $viewModel->country()) ?
              '<option value="' . xss($key) . '" selected>' . xss($value) . '</option>' :
              '<option value="' . xss($key) . '">' . xss($value) . '</option>';
          } ?>
        </select>
      </div>

      <!-- Search terms -->
      <div class="col-sm-10 col-md-4 mt-sm-3 mt-md-0 col-lg-3">
        <input type="text" class="form-control" name="searchTerms" id="searchTerms"
          <?php if ($searchTerms = $viewModel->searchTermsForForm()): ?>
            value="<?php echo htmlspecialchars($searchTerms, ENT_QUOTES, "UTF-8", false); ?>"
          <?php else: ?>
            placeholder="<?php echo TFISH_EXPERTS_OR_ENTER_SEARCH_TERMS; ?>"
          <?php endif; ?>
        required>
      </div>

      <div class="col-sm-2 mt-3 col-md-1 mt-md-0 mb-4">
        <button type="submit" class="btn btn-primary text-right" onclick = "setAction()">
            <?php echo TFISH_SEARCH ?>
        </button>
        <input type="hidden" id="action" name="action" value="display">
      </div>

    </div>
  </form>

  <script>
    function setAction() {
        document.getElementById("action").value="search";
    }
  </script>

  <!-- Search results -->
  <?php if ($_GET || $_POST): ?>

  <?php if ($searchResults = $viewModel->searchResults()): ?>

  <div class="row">
    <div class="col my-4">
      <hr>
        <div class="text-left">
          <h2><?php echo xss($viewModel->contentCount()) . ' ' . TFISH_SEARCH_RESULTS . ':'; ?></h2>
        </div>
      <hr>
    </div>
  </div>

  <?php if ($pagination ?? null): ?>
  <div class="row">
    <div class="col d-flex justify-content-end pagination-top clearfix">
      <?php echo $pagination; ?>
    </div>
  </div>
  <?php endif; ?>

  <?php foreach ($searchResults as $key => $object): ?>
  <div class="row stream-item">
    <div class="col">

      <div class="clearfix">
        <h3><a href="<?php echo $object->url(); ?>"><?php echo xss($object->name()); ?></a></h3>
        <?php if ($object->image()): ?>
        <div class="float-start">
          <figure class="figure-left">
            <a href="<?php echo $object->url(); ?>">
            <img class="img-responsive" src="<?php echo $object->cachedImage(100); ?>"
              title="<?php echo xss($object->name()); ?>"
              alt="<?php echo xss($object->name()); ?>" />
            </a>
          </figure>
        </div>
        <?php endif; ?>
      <div class="teaser"><?php echo $object->experienceForDisplay(); ?></div>
      </div>

    </div>
  </div>
  <?php endforeach; ?>

  <!-- Pagination -->
  <?php if ($pagination ?? null): ?>
  <div class="row">
    <div class="col d-flex justify-content-end pagination-bottom clearfix">
      <?php echo $pagination; ?>
    </div>
  </div>
  <?php endif; ?>

  <?php else: ?>
  <div class="row">
    <div class="col my-4">
      <hr>
        <div class="text-left">
          <h2><?php echo TFISH_SEARCH_NO_RESULTS; ?></h2>
        </div>
      <hr>
    </div>
  </div>
  <?php endif; ?>

  <?php endif; ?>

</div> <!-- ./container -->
